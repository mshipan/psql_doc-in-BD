# PostgreSQL ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи (ржмрж╛ржВрж▓рж╛)

<details>
<summary><strong>1. psql ржПржмржВ ржПрж░ ржбрж┐ржлрж▓рзНржЯ ржЖржЪрж░ржг, ржбрж╛ржЯрж╛ржмрзЗрж╕ рждрзИрж░рж┐ ржХрж░рж╛</strong></summary>

### ЁЯФ╢ psql ржХрзА?

psql рж╣рж▓рзЛ PostgreSQL-ржПрж░ ржПржХржЯрж┐ ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржЯрж╛рж░рзНржорж┐ржирж╛рж▓ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ, ржпрзЗржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржкрзНрж░рж╢рзНржи ржХрж░рждрзЗ (query) ржПржмржВ ржХржорж╛ржирзНржб ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЗржиред ржПржЯрж┐ PostgreSQL рж╕рж╛рж░рзНржнрж╛рж░ ржерзЗржХрзЗ рж╕рж░рж╛рж╕рж░рж┐ рж╕ржВржпрзБржХрзНржд рж╣рзЯрзЗ ржХрж╛ржЬ ржХрж░рзЗред

### ЁЯФ╢ psql ржПрж░ ржбрж┐ржлрж▓рзНржЯ ржЖржЪрж░ржг:

ржпржЦржи ржЖржкржирж┐ psql ржЪрж╛рж▓рж╛ржи, рждржЦржи ржПржЯрж┐ ржирж┐ржЪрзЗрж░ ржХрж╛ржЬржЧрзБрж▓рзЛ ржХрж░рзЗ:

1. ржбрж┐ржлрж▓рзНржЯ ржЗржЙржЬрж╛рж░ ржУ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ рж╣рзЯ:

- рж╕рж╛ржзрж╛рж░ржгржд ржЖржкржирж╛рж░ ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржЗржЙржЬрж╛рж░ржирзЗржЗржо ржЕржирзБржпрж╛рзЯрзА ржПржХржЗ ржирж╛ржорзЗрж░ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ рж╣рзЯред
- ржЙржжрж╛рж╣рж░ржг:

```bash
  $ psql
```

ржпржжрж┐ ржЖржкржирж╛рж░ ржЗржЙржЬрж╛рж░ржирзЗржЗржо shipan рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржПржЯрж┐ shipan ржирж╛ржорзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ рж╣ржУрзЯрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗред

2. ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржорзЛржбрзЗ ржХрж╛ржЬ ржХрж░рзЗ:

- ржЖржкржирж┐ рж╕рж░рж╛рж╕рж░рж┐ SQL ржХржорж╛ржирзНржб ржжрж┐рждрзЗ ржкрж╛рж░рзЗржиред
- ржкрзНрж░рждрж┐ржЯрж┐ ржХржорж╛ржирзНржб ; ржжрж┐рзЯрзЗ рж╢рзЗрж╖ ржХрж░рждрзЗ рж╣рзЯред

3. ржХрж┐ржЫрзБ ржХржорж╛ржирзНржб рж╢рзБрж░рзБ рж╣рзЯ \ ржжрж┐рзЯрзЗ:

- ржПржЧрзБрж▓рзЛ psql-specific internal command, ржпрзЗржоржи:
  - \l : рж╕ржорж╕рзНржд ржбрж╛ржЯрж╛ржмрзЗржЬрзЗрж░ рждрж╛рж▓рж┐ржХрж╛
  - \c dbname : ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ
  - \dt : ржЯрзЗржмрж┐рж▓ рждрж╛рж▓рж┐ржХрж╛
  - \q : psql ржерзЗржХрзЗ ржмрзЗрж░ рж╣ржУрзЯрж╛

### ЁЯФ╖ PostgreSQL-ржП ржбрж╛ржЯрж╛ржмрзЗржЬ рждрзИрж░рж┐

ржбрж╛ржЯрж╛ржмрзЗржЬ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛рзЯ ржжрзБржЗржнрж╛ржмрзЗ:

1. SQL ржХржорж╛ржирзНржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:

```sql
  CREATE DATABASE database_name;
```

2. psql ржЗржирзНржЯрж╛рж░ржлрзЗрж╕рзЗ createdb ржХржорж╛ржирзНржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:

```bash
  $ createdb company_db
```

ржжрзБржЗ ржХржорж╛ржирзНржб ржПржХржЗ ржХрж╛ржЬ ржХрж░рзЗ тАФ ржкрж╛рж░рзНржержХрзНржп рж╣рж▓рзЛ, ржкрзНрж░ржержоржЯрж┐ SQL ржХржорж╛ржирзНржб, ржжрзНржмрж┐рждрзАрзЯржЯрж┐ psql-ржПрж░ CLI utility

### ЁЯФ╖ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ рж╣ржУрзЯрж╛:

```bash
  $ psql -d database_name
```

ржЕржержмрж╛ psql ржЪрж╛рж▓рж┐рзЯрзЗ, ржПрж░ ржкрж░рзЗ \c ржХржорж╛ржирзНржб:

```sql
  \c company_db
```

### ЁЯФ╖ рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржЙржжрж╛рж╣рж░ржг:

```bash
  $ createdb testdb     # ржбрж╛ржЯрж╛ржмрзЗржЬ рждрзИрж░рж┐
  $ psql                # psql ржЪрж╛рж▓рзБ
```

```sql
  \c testdb             -- ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ
  CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100)
  );                    -- ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐
```

### ЁЯФО ржЯрж┐ржкрж╕:

| ржХржорж╛ржирзНржб      | ржХрж╛ржЬ                  |
| ----------- | -------------------- |
| `\l`        | рж╕ржорж╕рзНржд ржбрж╛ржЯрж╛ржмрзЗржЬ ржжрзЗржЦрж╛рзЯ  |
| `\c dbname` | ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржХрж╛ржирзЗржХрзНржЯ     |
| `\dt`       | ржЯрзЗржмрж┐рж▓ рждрж╛рж▓рж┐ржХрж╛ ржжрзЗржЦрж╛рзЯ   |
| `\q`        | `psql` ржерзЗржХрзЗ ржмрзЗрж░ рж╣ржУрзЯрж╛ |

</details>

<details>
<summary><strong>2. ржЗржЙржЬрж╛рж░, рж░рзЛрж▓ ржУ ржкрзНрж░рж┐ржнрж┐рж▓рзЗржЬ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ</strong></summary>

### ЁЯФ╢ рж░рзЛрж▓ (Role) ржХрзА?

PostgreSQL-ржП Role ржмрж▓рждрзЗ ржЗржЙржЬрж╛рж░ ржПржмржВ ржЧрзНрж░рзБржк ржжрзБржЯрзЛржЗ ржмрзЛржЭрж╛рзЯред рж░рзЛрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐:

- ржЗржЙржЬрж╛рж░ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи
- ржмрж┐ржнрж┐ржирзНржи ржЕржзрж┐ржХрж╛рж░ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи
- ржЧрзНрж░рзБржк рж░рзЛрж▓рзЗрж░ ржорждрзЛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХрж╛ржзрж┐ржХ ржЗржЙржЬрж╛рж░ржХрзЗ ржПржХржЗ ржЕржзрж┐ржХрж╛рж░ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи

тЬЕ Role = User = Group (PostgreSQL-ржП ржПрж░рж╛ ржПржХржЗ ржЬрж┐ржирж┐рж╕)

### ЁЯФ╖ рж░рзЛрж▓ рждрзИрж░рж┐ ржХрж░рж╛ (Creating Roles):

```sql
  CREATE ROLE role_name;
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  CREATE ROLE shipan;
```

ржПржЗ рж░рзЛрж▓ ржжрж┐рзЯрзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж▓ржЧржЗржи ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛, ржХрж╛рж░ржг ржПржЦржирзЛ LOGIN ржкрж╛рж░ржорж┐рж╢ржи ржжрзЗржУрзЯрж╛ рж╣рзЯржирж┐ред

### ЁЯФ╖ рж▓ржЧржЗржи рж░рзЛрж▓ рждрзИрж░рж┐ ржХрж░рж╛ (Login Privilege рж╕рж╣):

```sql
  CREATE ROLE username WITH LOGIN PASSWORD 'your_password';
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  CREATE ROLE shipan WITH LOGIN PASSWORD '1234';
```

ржПржЦржи shipan ржирж╛ржорзЗрж░ ржПржЗ рж░рзЛрж▓ ржжрж┐рзЯрзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж▓ржЧржЗржи ржХрж░рж╛ ржпрж╛ржмрзЗред

### ЁЯФ╖ SUPERUSER рж░рзЛрж▓ рждрзИрж░рж┐:

```sql
  CREATE ROLE admin WITH LOGIN SUPERUSER PASSWORD 'admin123';
```

ржПржЗ рж░рзЛрж▓ржЯрж┐ PostgreSQL-ржПрж░ рж╕рж░рзНржмрзЛржЪрзНржЪ ржЕржирзБржорждрж┐рж╕ржорзНржкржирзНржи ржЕрзНржпрж╛ржбржорж┐ржи рж░рзЛрж▓ред

### ЁЯФ╖ ржЕржзрж┐ржХрж╛рж░ (Privileges) ржХрзА ржХрзА ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ?

| Privilege | ржХрж╛ржЬ                                  |
| --------- | ------------------------------------ |
| `SELECT`  | ржбрзЗржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗ                      |
| `INSERT`  | ржбрзЗржЯрж╛ ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗ                   |
| `UPDATE`  | ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗ                 |
| `DELETE`  | ржбрзЗржЯрж╛ ржорзБржЫрждрзЗ ржкрж╛рж░рзЗ                      |
| `CREATE`  | ржЯрзЗржмрж┐рж▓, рж╕рзНржХрж┐ржорж╛ ржЗрждрзНржпрж╛ржжрж┐ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗ |
| `CONNECT` | ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж╕ржВржпрзБржХрзНржд рж╣рждрзЗ ржкрж╛рж░рзЗ            |

### ЁЯФ╖ рж░рзЛрж▓ржХрзЗ ржПржХржЯрж┐ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржжрзЗржУрзЯрж╛рж░ ржЬржирзНржп:

```sql
  GRANT CONNECT ON DATABASE your_db TO role_name;
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  GRANT CONNECT ON DATABASE company_db TO shipan;
```

### ЁЯФ╖ рж░рзЛрж▓ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЯрзЗржмрж┐рж▓рзЗ SELECT ржмрж╛ ржЕржирзНржпрж╛ржирзНржп ржЕржзрж┐ржХрж╛рж░ ржжрзЗржУрзЯрж╛:

```sql
  GRANT SELECT, INSERT ON TABLE table_name TO role_name;
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  GRANT SELECT, INSERT ON TABLE employees TO shipan;
```

### ЁЯФ╖ рж░рзЛрж▓рзЗрж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржкрж░рж┐ржмрж░рзНрждржи (e.g., PASSWORD, LOGIN):

```sql
  ALTER ROLE role_name WITH PASSWORD 'new_password';
  ALTER ROLE role_name WITH LOGIN;
```

### ЁЯФ╖ рж░рзЛрж▓ ржорзБржЫрзЗ ржлрзЗрж▓рж╛:

```sql
  DROP ROLE role_name;
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  DROP ROLE shipan;
```

тЪая╕П ржпржжрж┐ рж░рзЛрж▓ржЯрж┐ ржХрзЛржирзЛ ржбрж╛ржЯрж╛ржмрзЗржЬ ржмрж╛ ржЯрзЗржмрж┐рж▓рзЗрж░ ржорж╛рж▓рж┐ржХ рж╣рзЯ, ржЖржЧрзЗ рж╕рзЗржЗ ржорж╛рж▓рж┐ржХрж╛ржирж╛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣ржмрзЗред

### ЁЯФ╖ ржПржХржЬржи рж░рзЛрж▓ржХрзЗ ржЖрж░рзЗржХржЯрж┐ рж░рзЛрж▓рзЗрж░ ржорзЗржорзНржмрж╛рж░ ржмрж╛ржирж╛ржирзЛ (Role Inheritance):

```sql
  GRANT parent_role TO child_role;
```

ржЙржжрж╛рж╣рж░ржг:

```sql
  GRANT developers TO shipan;
```

ржПржЦржи shipan рж░рзЛрж▓ржЯрж┐ developers рж░рзЛрж▓рзЗрж░ рж╕ржм ржЕржзрж┐ржХрж╛рж░ ржкрж╛ржмрзЗред

### ЁЯза рж╕ржВржХрзНрж╖рзЗржкрзЗ ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржорждрзЛ:

| ржХрж╛ржЬ           | ржХржорж╛ржирзНржб                                         |
| ------------- | ---------------------------------------------- |
| рж░рзЛрж▓ рждрзИрж░рж┐      | `CREATE ROLE name;`                            |
| рж▓ржЧржЗржи рж░рзЛрж▓      | `CREATE ROLE name WITH LOGIN PASSWORD 'pass';` |
| ржЕржзрж┐ржХрж╛рж░ ржжрзЗржУрзЯрж╛  | `GRANT SELECT ON table TO role;`               |
| ржЕржзрж┐ржХрж╛рж░ ржмрж╛рждрж┐рж▓  | `REVOKE SELECT ON table FROM role;`            |
| рж░рзЛрж▓ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ | `DROP ROLE name;`                              |

</details>
